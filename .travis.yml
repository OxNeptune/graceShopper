language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "Grace-Shopper-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: ox-neptune # see README
  api_key:
    secure: cE5a5y+ClLx2W//sgNkQLPE0NOEpRb2zNpC5G8VzGwuXk0tlNJoO+umwgqxso3DwxzY/eO8JOkzj++wO+GUv22nIBZzN16a4ifXw7rpzmeQA9UvtOT3UaXR5Zx6X/MULLs0IEDcrTDfCUkRsbG7192KgfpiyT8JTX565k7zM7LjclQjltpax6+4iUK+EPL59OWBTSJADc2hooFMh8h6tCTHqiWCO9BwZow1SZw/JqUYXs6E/Kc23Fh3whk2/Es4VCDidq3e4dEERrgJ5dSPquundxv8NsI2bPbD5a78b2SX4XhfKj+lUV9h2aTLKUMONNdxWuMzSkhBlHaPqLjgrTYVJN+NrkVfC8P6wzxxShbZXQ+OM7M/lCn5YTUT0A6uyCM6LAcfSio/NXuytxNTIUoMZkdf3/y1aB+Hzk2EZfgaRF0B+7Lo78CjIsPhnK2JE1D7TQqYoCC0RU3CYrf6Aq/CMGNaZknUHmciex14ztz8r+LwTCcwF3LMIjaFcEUlsVDOeUNvZNuSoRsZ8RlzZFtOqlAZvlxMwVj99BJbzZATxp0LwtV3DpO5YsaO2IA09GFDprN+l+lnWxAxkH9w3GrtWKTSIoiwxrfLvdbvEta/9a7Zaobw5SCtxwlJuXKS9psv18QDdAbqP40fMj51g1nmJBGKnxkp3GtwqK4wsOYU=
